package cvesearchapi

import (
	"overseer/apps"
	"time"
)

// A test Search that has a list of preset
// vulnerable applications.
type testSearch struct {
	distribution map[apps.App]bool
	important    []apps.App
}

func (t *testSearch) RecentVuln(app apps.App) bool {
	val, ok := t.distribution[app]
	return val && ok
}

func (t *testSearch) LatestVuln(app apps.App) time.Time {
	val, ok := t.distribution[app]
	if val && ok {
		return time.Now()
	} else {
		return time.Now().AddDate(-1, 0, 0)
	}
}

func (t *testSearch) Supported(app apps.App) bool {
	_, ok := t.distribution[app]
	return ok
}

func NewTestSearch() {

}
